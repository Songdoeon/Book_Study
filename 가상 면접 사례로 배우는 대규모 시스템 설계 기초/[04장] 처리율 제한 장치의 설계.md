## 🌈 Chapter 4: 처리율 제한 장치의 설계

<details><summary>정리</summary>

    - 커밋을 생활화 하자....
    
</details>

- 네트워크 시스템에서 처리율 제한 장치는 클라이언트 또는 서비스가 보내는 트래픽의 처리율을 제어하기 위한 장치다.
- HTTP를 예로 들면 이 장치는 특정 기간 내에 전송되는 클라이언트의 요청 횟수를 제한한다.
- API 요청 횟수가 제한 장치에 정의된 임계치를 넘어서면 추가로 도달한 모든 호출은 처리가 중단된다.
  - 사용자는 초당 2회 이상 새 글을 올릴 수 없다.
  - 같은 IP 주소로는 하루에 10개 이상의 계정을 생성할 수 없다.
  - 같은 디바이스로는 주당 5회 이상 리워드를 요청할 수 없다.

#### 🎈 처리율 제한 장치의 장점
- DoS 공격에 의한 자원 고갈 방지

  → 대형 IT 기업들이 공개한 거의 대부분의 API는 처리율 제한 장치를 갖고 있다.
  
- 비용 절감
  
  - 서버를 많이 두지 않아도 되고, 우선순위가 높은 API에 더 많은 자원을 할당할 수 있다.
  - 제 3자 API에 사용료를 지불하고 사용하는 경우

    → 신용을 확인하거나 신용카드 결제를 하기 위해 호출하는 API에 대한 횟수에 따라 비용이 청구 될 경우
    
- 서버 과부하 방지
  - 봇에서 오는 트래픽이나 사용자의 잘못된 이용 패턴으로 유발된 트래픽을 걸러내는데 처리율 제한 장치를 활용할 수 있다.
 
### 📚 1단계 : 문제 이해 및 설계 범위 확정
---
- 처리율 제한 장치 알고리즘은 각각 고유한 장단점을 가지고 있다.
- 면접관과의 소통으로 어떤 제한 장치를 구현해야 하는 분명히 하자.

#### 🎈 요구사항
- 설정된 처리율을 초과하는 요청은 정확하게 제한한다.
- 낮은 응답시간
  - 이 처리율 제한 장치는 HTTP 응답시간에 나쁜 영향을 주어서는 곤란하다.
- 가능한 한 적은 메모리를 써야 한다.
- 분산형 처리율 제한(distributed rate limiting)
  - 하나의 처리율 제한 장치를 여러 서버나 프로세스에서 공유할 수 있어야 한다.
- 예외 처리: 요청이 제한되었을 때는 그 사실을 사용자에게 분명하게 보여주어야 한다.
- 높은 결함 감내성(fault tolerance)
  - 제한 장치에 장애가 생기더라도 전체 시스템에 영향을 주어서는 안 된다.
 
   
### 📚 2단계 : 개략적 설계안 제시 및 동의 구하기
---
- 기본적인 클라이언트 - 서버 통신 모델을 사용하도록 하자.

#### 🎈 처리율 제한 장치는 어디에 둘 것인가?
- 직관적으로 보자면 이 장치는 클라이언트, 서버 측 양측에 둘 수 있다.
- 클라이언트
  
  - 클라이언트는 처리율 제한을 안정적으로 걸 수 있는 장소가 아니다.
  - 클라이언트 요청은 쉽게 위변조가 가능, 모든 클라이언트의 구현을 통제하는 것도 어렵다.
 
- 서버
  - 처리율 제한 장치를 API 서버에 둔다.
    ![image](https://github.com/Songdoeon/Book_Study/assets/96420547/d9d47440-885d-497a-8c2f-8a0bd3a3506e)

  - 처리율 제한 미들웨어를 만들어 API 서버로 가는 요청을 통제한다.
    ![image](https://github.com/Songdoeon/Book_Study/assets/96420547/4f539853-2050-4fb4-a4ca-cd0904c41eea)

- 폭 넓게 
