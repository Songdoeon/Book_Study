## 🌈 Chapter 6 : 키-값 저장소 설계

<details><summary>정리</summary>

  

</details>

이번 장에서는 재밌으면서도 고전적인 시스템 설계 문제 가운데 하나인 tiny url 같은 URL 단축기를 설계하는 문제를 풀어보도록 하겠다.

### 📚 1단계 : 문제 이해 및 설계 범위 확정
---

> 지원자: URL 단축기가 어떻게 동작해야 하는지 예제를 보여주실 수 있을까요?
> 
> 면접관: `https://www.systeminterview.com/q=chatsystem&c=loggedin&v=v3&l=long` 이 주어지면 이 서비스는
> `https://tinyurl.com/y7ke-ocwj`와 같은 단축 URL을 결과로 제공해야 합니다. 이 URL에 접속하면 원래 URL로 갈 수도 있어야 하죠.
> 
> 지원자: 트래픽 규모는 어느 정도일까요?
> 
> 면접관: 매일 1억(100million)개의 단축 URL을 만들어 낼 수 있어야 합니다.
> 
> 지원자: 단축 URL 길이는 어느 정도여야 하나요?
> 
> 면접관: 짧으면 짧을수록 좋습니다.
> 
> 지원자: 단축 URL 문자에 제한이 있습니까?
> 
> 면접관: 숫자(0 ~ 9)와 영문자(a-z, A-Z)만 사용할 수 있습니다.
> 
> 지원자: 단축된 URL을 시스템에서 지우거나 갱신할 수 있습니까?
> 
> 면접관: 시스템 단순화를 위해 삭제나 갱신은 할 수 없다고 가정합시다.
>
> 
이 시스템의 기본적 기능은 다음과 같다.

- URL 단축: 주어진 긴 URL을 훨씬 짧게 줄인다.
- URL redirection: 축약된 URL로 HTTP 요청이 오면 원래 URL로 안내
- 높은 가용성과 규모 확장성, 그리고 장애 감내가 요구됨

#### 🎈 개략적 추정

- 쓰기 연산: 매일 1억 개의 단축 URL 생성
- 초당 쓰기 연산: 1억 / 24 / 3600 = 1160
- 읽기 연산: 읽기 연산과 쓰기 연산의 비율은 10:1이라 하자. 그 경우 읽기 연산은 초당 11,600회 발생한다.
- URL 단축 서비스를 10년간 운영한다 가정하면 1억 * 365 * 10 = 3650억 개의 레코드를 보관해야 한다.
- 축약 전 URL의 평균 길이는 100이라고 하자.
- 10년 동안 필요한 저장 용량은 3650억 * 100바이트 = 36.5TB다.


### 📚 2단계 : 개략적 설계안 제시 및 동의 구하기
--- 
API 엔드포인트, URL 리디렉션, URL 단축 플로우에 대해 살펴보자

#### 🎈 API 엔드포인트
클라이언트는 서버가 제공하는 API 엔드포인트를 통해 서버와 통신한다.

REST API 스타일로 엔드포인트를 설계해보자.

- URL 단축용 엔드포인트
  
  - 새 단축 URL을 생성하고자 하는 클라이언트는 이 엔드포인트에 단축할 URL을 인자로 실어서 POST 요청을 보내야 한다.
  - Ex) POST /api/v1/data/shorten
    - 인자 : {longURL : longURLstring}
    - 반환 : 단축 URL
- URL 리디렉션용 엔드포인트
  - 단축 URL에 대해서 HTTP 요청이 오면 원래 URL로 보내주기 위한 용도의 엔드포인트
  - Ex) GET /api/v1/shortURL
     - 반환 : HTTP 리디렉션 목적지가 될 원래 URL

#### 🎈 URL 리디렉션


    
