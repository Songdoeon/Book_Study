## 🌈 Chapter 5 : 네트워크 계층 : 목적지에 데이터 전달하기

### 📚 LESSEN 17 : 네트워크 계층의 역할
---
네트워크 계층의 역할과 네트워크 간의 연결에 대해 알아보자.

#### 🎈 네트워크 간의 연결 구조
다른 네트워크에 있는 목적지로 데이터를 전달하려면 네트워크 계층의 기술이 필요하다.

- 데이터 링크 계층에서는 이더넷 규칙을 기반으로 데이터의 전송을 담당한다. 
  - 하지만 이 규칙으론 인터넷이나 다른 네트워크로는 데이터를 전송할 수 없다.
- 수많은 네트워크가 연결된 환경에서 데이터 링크 계층만으로는 다른 네트워크로 데이터를 전송하기 힘들다.

그렇기에 네트워크 계층을 통해 라우터 라는 네트워크 장비를 이용하여 데이터를 전송한다.

- 라우터는 데이터의 목적지가 정해지면 해당 목적지까지 어떤 경로로 가는 것이 좋은지 알려주는 기능을 한다.
  - 하지만 목적지 주소를 모른다면 라우터도 경로를 알려주지 못한다.
- 랜에서는 MAC 주소만으로 통신할 수 있지만 다른 네트워크와 통신에는 IP 주소가 필요하다.
  - IP 주소란 어떤 네트워크의 어떤 컴퓨터인지를 구분할 수 있도록 하는 주소이다.
- IP 주소로 목적지를 지정하고 어떤 경로로 보낼지도 결정해야 한다.
  - IP 주소까지 어떤 경로로 데이터를 보낼지 결정하는 것을 라우팅(Routing)이라 한다.
- 라우팅 테이블을 통하여 경로 정보를 등록, 관리한다.

#### 🎈 IP
네트워크 계층에는 IP라는 프로토콜이 있습니다.

네트워크 계층에서는 캡슐화할 때 IP 헤더를 붙이는데 구성요소는 다음과 같다.
<img src = "https://github.com/Songdoeon/Book_Study/assets/96420547/59836f9c-5c36-477b-b245-61b72f276496" width = 600 height = 500> 

여기서는 출발지 IP 주소와 목적지 IP 주소 정도만 기억하자.

이처럼 IP 프로토콜을 사용하여 캡슐화 할 때는 데이터에 IP 헤더가 추가되는데, 이렇게 만들어진 것을 IP 패킷이라고 한다.

데이터 링크 계층에서는 프레임, 네트워크 계층에서는 패킷 이라고 한다.


### 📚 LESSEN 18 : IP 주소의 구조
---
네트워크간 통신에 쓰는 IP 주소의 구조에 대해 알아보자.

#### 🎈 IP 주소
- IP 주소는 ISP(Internet Service Proviser)에게 받을 수 있다.
- IP 버전은 IPv4, IPv6가 있다.
  - v4는 32비트로 구성되어 약 43억개의 주소를 만들 수 있다.
  - v6는 128비트로 구성되어 약 340간개로 사실상 무한대의 주소를 만들 수 있다.
- IP 주소에는 공인 IP 주소, 사설 IP 주소가 있다.
  - 공인 IP 주소는 ISP가 제공한다.
  - 인터넷에 직접 연결되는 컴퓨터나 라우터에는 공인 IP 주소를 할당한다.
  - 회사나 가정의 랜에 있는 컴퓨터는 사설 IP 주소를 할당한다.
- IP 주소는 네트워크 ID와 호스트 ID로 나눠져 있다.
  - 네트워크 ID는 어떤 네트워크인지 나타낸다.
  - 호스트 ID는 해당 네트워크의 어느 컴퓨터인지 나타낸다.
  - 이 두가지 정보가 합쳐져 IP 주소가 된다.

공인 IP 주소는 라우터에만 할당하고 랜 안에 있는 컴퓨터들에는 랜의 네트워크 관리자가 사설 IP 주소를 할당하거나 라우터의 DHCP(Dynamic Host Configuration Protocol) 기능을 사용하여 IP 주소를 자동으로 할당한다.
  > DHCP : 동적 주소 할당 방식

IP 주소를 변환하는 법은 생략하도록 하겠다.

### 📚 LESSEN 19 : IP 주소의 클래스 구조
IP 주소는 네트워크의 규모에 따라 A ~ E 클래스로 나눠져 있다.

네트워크 클래스의 구조에 대해 알아보자.

#### 🎈 IP 주소 클래스
IPv4의 IP 주소는 32비트다.

비트로 구분하지만 네트워크 ID를 크게 만들거나 호스트 ID를 작게 만들어 네트워크 크기를 조정할 수도 있다.

네트워크 크기는 클래스 라는 개념으로 구분하고 있다.
  
|클래스이름|내용|클래스이름|내용|
|--|--|--|--|
|A 클래스|대규모 네트워크 주소|D 클래스|멀티캐스트(multicast) 주소|
|B 클래스|중형 네트워크 주소|E 클래스|연구 및 특수용도 주소|
|C 클래스|소규모 네트워크 주소|

- A 클래스
  - 처음 8비트가 네트워크 ID, 다음 24비트가 호스트 ID이다.
- B 클래스
  - 처음 16비트가 네트워크 ID, 다음 16비트가 호스트 ID이다.
- C 클래스
  - 처음 24비트가 네트워크 ID, 다음 8비트가 호스트 ID이다.

<img src = "https://github.com/Songdoeon/Book_Study/assets/96420547/fc90a9a2-b415-4447-a5f0-e9ab6eba697c" width = 700 height = 300>

### 📚 LESSEN 20 : 네트워크 주소와 브로드캐스트 주소의 구조
컴퓨터에 할당할 수 없느 IP 주소인 네트워크 주소와 브로드캐스트 주소에 대해 알아보자.

#### 🎈 네트워크 주소와 브로드캐스트 주소
IP 주소는 네트워크 주소와 브로드캐스트 주소가 있다.

이 두 주소는 특별한 주소로 컴퓨터나 라우터가 자신의 IP로 사용하면 안 되는 주소다.

- 네트워크 주소
  - 전체 네트워크에서 작은 네트워크를 식별하는 데 사용되는 주소다.
  - 호스트 ID가 10진수로 0이면 그 네트워크 전체를 대표하는 주소가 된다.
- 브로드캐스트 주소
  - 네트워크에 있는 컴퓨터나 장비 모두에게 한 번에 데이터를 전송하는 데 사용되는 전용 IP 주소이다.
  - 호스트 ID 255를 설정하면 해당 네트워크 안에 있는 모든 장비들이 데이터를 받게 된다.

### 📚 LESSEN 21 : 서브넷의 구조
네트워크를 분할하는 것을 서브넷팅이라 한다.

서브넷의 구조에 대해 알아보자.

#### 🎈 서브넷
많은 수의 컴퓨터가 브로드캐스트 패킷을 전송하면 모든 컴퓨터에 패킷이 전송되고 네트워크가 혼잡해 질 것이다.

다음과 같이 A 클래스의 대규모 네트워크를 작은 네트워크로 분할하여 브로드캐스트의 범위를 좁힐 수 있다.
<img src = "https://github.com/Songdoeon/Book_Study/assets/96420547/790909c7-8497-4ebf-9e61-af7963e1e87d" width = 700 height = 450>

이처럼 네트워크를 분할하는 것을 서브넷팅(subneting), 그리고 분할된 네트워크를 서브넷(subnet)이라 한다.

<img src = "https://github.com/Songdoeon/Book_Study/assets/96420547/79c6b5bc-608b-4487-9537-0746bd22e81a" width = 600 height = 500>

위와 같이 호스트 ID로 사용되던 비트를 서브넷 ID로 바꾸어 사용할 수 있다.

#### 🎈 서브넷 마스크
IP 주소를 서브넷팅 하면 어디까지가 네트워크 ID인지 판단하기 어려워진다. 그럴때 서브넷 마스크 값을 사용한다.

서브넷 마스크는 네트워크 ID와 호스트 ID를 식별하기 위한 값이다.

클래스별 서브넷 마스크는 다음과 같다.
- A 클래스 : 255.0.0.0, /8
- B 클래스 : 255.255.0.0, /16
- C 클래스 : 255.255.255.0, /24
- Ex) 255.255.255.240 = /28로 표현이 가능하다.

### 📚 LESSEN 22 : 라우터의 구조
서로 다른 네트워크와 통신하려면 라우터가 필요하다.

#### 🎈 라우터란?
라우터는 다음과 같이 네트워크를 분리할 수 있다.

<img src = "https://github.com/Songdoeon/Book_Study/assets/96420547/6819a702-72a9-4cd2-9304-f8dcce7bbb55" width = 600 height = 500>

- Ex)컴퓨터 1이 컴퓨터 6에 접속하려고 가정한다.
- 다른 네트워크에 데이터를 전송하려면 라우터의 IP 주소를 설정해야 한다.
  - 이것은 네트워크의 출입구를 설정하는 것으로 기본 게이트웨이라고 한다.
- 컴퓨터 1은 다른 네트워크로 ㄹ데이터를 보낼 때 어디로 전송해야 하는지 알지 못한다.
- 일단 네트워크의 출입구를 지정하고 라우터로 데이터를 전송한다.

그 다음 추가로 라우팅 기능이 필요하다.


#### 🎈 라우팅
라우팅은 경로 정보를 기반으로 현재의 네트워크에서 다른 네트워크로의 최적의 경로를 통해 데이터를 전송한다.

이 경로 정보가 등록되어 있는 테이블이 라우팅 테이블이다.

<img src = "https://github.com/Songdoeon/Book_Study/assets/96420547/66732f65-89f8-4d96-953d-506233179065" width = 600 height = 500>

- 라우팅 테이블 관리는 네트워크 관리자가 수동으로 등록하거나, 자동으로 등록하는 방법을 이용한다.
- 수동 등록은 소규모 네트워크, 자동 등록은 대규모 네트워크에 적합하다.
- 자동 등록은 라우터 간 경로 정보를 서로 교환하여 라우팅 테이블 정보를 자동으로 수정한다.
- 이러한 정보 교환을 위한 프로토콜이 라우팅 프로토콜이다.
  - RIP, OSPF, BGP 등이 있다.


